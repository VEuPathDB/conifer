#!/usr/bin/perl

my $branch = $ARGV[0];
use strict;
usage() unless ($branch);


my @projects = ('ApiCommonData:apidb', 'ApiCommonShared:apidb', 'ApiCommonWorkflow:apidb', 'CBIL:gus', 'DoTS:apidb', 'EuPathDatasets:apidb', 'FgpUtil:gus', 'GGTools:apidb', 'GusAppFramework:gus', 'GusSchema:gus', 'install:gus', 'OrthoMCLData:apidb', 'OrthoMCLEngine:apidb', 'OrthoMCLShared:apidb', 'ReFlow:gus', 'WDK:gus', 'WSF:gus');


my $url = 'https://www.cbil.upenn.edu/svn';
foreach my $project (@projects) {
  my ($name, $repository) = split(/:/, $project);
  my $target = "$url/$repository/$name/branches/$branch";
  my $dirName = $name;
  $dirName = "GUS" if $dirName eq 'GusAppFramework';
  my $cmd = "svn co $target $dirName";
  print STDERR "$name\n";
  system($cmd) == 0 || die "Failed checking out '$name'\n";
}

sub usage {
  die "

Check out a specified branch of the Fgp backend projects into the current dir.  cd to target \$PROJECT_HOME first.

usage: fgpBackendCheckout branch_number

";
}
